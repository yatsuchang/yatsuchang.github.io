(this["webpackJsonppolyplay-admin"]=this["webpackJsonppolyplay-admin"]||[]).push([[7],{1439:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n.n(a),i=n(90),o=n(50),l=n(354),s=n(357),u=n(109),c=n(24),m=n(65),d=n(72),p=n(91),b=n(0),T=n(499),y=n(149),h=n(1424),f=n(1435),g=n(1443),j=n(384),O=n(375),x=n(125),v=n.n(x),w=n(523),k=n(524),D=n(508),S=n.n(D),B=n(440),A=n(15),C=n(522),F=n(41),U=n(7),M=Object(l.a)((function(e){return{root:{paddingBottom:24},form:{"& > * + *":{marginTop:16}},row:{display:"flex",alignItems:"center","& > * + *":{marginLeft:8}},date:{position:"relative","& svg":{color:e.colors.white}},dateLabel:{color:e.colors.white},button:{"& span":{fontWeight:600,color:e.colors.black},"&:disabled":{backgroundColor:"".concat(Object(F.a)(.8,e.colors.white)," !important")}},label:{color:e.colors.white,marginBottom:5},imagesRow:{display:"flex",overflowX:"auto",paddingBottom:12},imageItem:{marginRight:12,position:"relative","& img":{height:118,minWidth:120,border:"1px dashed ".concat(e.colors.default),borderRadius:16},"& button":{position:"absolute",top:12,right:12,padding:8,backgroundColor:e.colors.black,color:e.colors.white}}}})),I=function(e){var t=M(),n=Object(p.b)().enqueueSnackbar,a=Object(d.b)(),o=a.setTxModalInfo,l=a.account,c=a.networkId,b={website:"",telegram:"",twitter:"",discord:"",logo:"",title:"",description:"",logoFile:null,logoObjectUrl:"",tokenDecimals:18,tokenSymbol:"",images:[],imageFiles:[],imageObjectUrls:[],saleTarget:0,fundToken:"",fundTarget:0,startTime:S()().format("YYYY-MM-DDTHH:m"),endTime:S()().format("YYYY-MM-DDTHH:m"),claimTime:S()().format("YYYY-MM-DDTHH:m"),minFundAmount:0,baseAmount:0};return Object(U.jsx)("div",{className:t.root,children:Object(U.jsx)(w.b,{initialValues:b,onSubmit:function(){var t=Object(i.a)(r.a.mark((function t(a,i){var l,s,u,d,p,b,T,y,h,f;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=i.setSubmitting,s=S()(a.startTime).unix(),u=S()(a.endTime).unix(),d=S()(a.claimTime).unix(),!(s>u)){t.next=7;break}return n("StartTime should be earlier than EndTime",{variant:"error"}),t.abrupt("return");case 7:if(!(d<u)){t.next=10;break}return n("EndTime should be earlier than ClaimTime",{variant:"error"}),t.abrupt("return");case 10:if(a.logoFile){t.next=13;break}return n("Please select Logo",{variant:"error"}),t.abrupt("return");case 13:return l(!0),o(!0,"Uploading meta data to fleek ..."),t.prev=15,t.next=18,Object(B.b)(a.logoFile);case 18:return p=t.sent,t.next=21,Promise.all(a.imageFiles.map((function(e){return Object(B.b)(e)})));case 21:return b=t.sent,T={website:a.website,telegram:a.telegram,twitter:a.twitter,discord:a.discord,description:a.description,title:a.title,tokenDecimals:a.tokenDecimals,tokenSymbol:a.tokenSymbol,logo:p,images:b},console.log("===metaData===",T),t.next=26,Object(B.a)(JSON.stringify(T));case 26:return y=t.sent,console.log("====metaUri=====",y),h=Object(m.d)(a.fundToken,c),f={meta:y,saleTarget:Object(C.parseUnits)(a.saleTarget.toString(),a.tokenDecimals),fundToken:a.fundToken,fundTarget:Object(C.parseUnits)(a.fundTarget.toString(),h.decimals),startTime:A.a.from(S()(a.startTime).unix()),endTime:A.a.from(S()(a.endTime).unix()),claimTime:A.a.from(S()(a.claimTime).unix()),minFundAmount:Object(C.parseUnits)(a.minFundAmount.toString(),h.decimals),baseAmount:Object(C.parseUnits)(a.baseAmount.toString(),h.decimals)},console.log("====idoData====",f),t.next=33,e.onSubmit(f);case 33:l(!1),t.next=40;break;case 36:t.prev=36,t.t0=t.catch(15),l(!1),o(!1);case 40:case"end":return t.stop()}}),t,null,[[15,36]])})));return function(e,n){return t.apply(this,arguments)}}(),validationSchema:k.b().shape({website:k.c().matches(/^(https)/).required(),telegram:k.c().matches(/^(https)/),twitter:k.c().matches(/^(https)/),discord:k.c().matches(/^(https)/),title:k.c().required(),description:k.c().required(),saleTarget:k.a().positive(),fundToken:k.c().matches(/^0x[a-fA-F0-9]{40}$/).required(),startTime:k.c().required(),endTime:k.c().required(),claimTime:k.c().required(),minFundAmount:k.a().positive(),baseAmount:k.a().positive(),tokenSymbol:k.c().required()}),children:function(e){var n=e.errors,a=e.handleBlur,r=e.handleChange,i=e.handleSubmit,o=e.isSubmitting,d=e.isValid,p=e.setFieldValue,b=e.touched,T=e.values;return Object(U.jsxs)(w.a,{className:t.form,onSubmit:i,children:[Object(U.jsx)(h.a,{error:Boolean(b.website&&n.website),fullWidth:!0,helperText:b.website&&n.website,id:"website",label:"Website",name:"website",onBlur:a,onChange:r,placeholder:"https://",value:T.website}),Object(U.jsx)(h.a,{error:Boolean(b.telegram&&n.telegram),fullWidth:!0,helperText:b.telegram&&n.telegram,id:"telegram",label:"Telegram",name:"telegram",onBlur:a,onChange:r,placeholder:"https://",value:T.telegram}),Object(U.jsx)(h.a,{error:Boolean(b.twitter&&n.twitter),fullWidth:!0,helperText:b.twitter&&n.twitter,id:"twitter",label:"Twitter",name:"twitter",onBlur:a,onChange:r,placeholder:"https://",value:T.twitter}),Object(U.jsx)(h.a,{error:Boolean(b.discord&&n.discord),fullWidth:!0,helperText:b.discord&&n.discord,id:"discord",label:"Discord",name:"discord",onBlur:a,onChange:r,placeholder:"https://",value:T.discord}),Object(U.jsx)(u.b,{id:"logo-uploader",onChange:function(e){p("logoFile",e),T.logoObjectUrl&&URL.revokeObjectURL(T.logoObjectUrl),p("logoObjectUrl",e?URL.createObjectURL(e):"")},placeholder:"Please upload Logo (100*100)",size:{width:100,height:100},value:{file:T.logoFile,fileUrl:T.logoObjectUrl}}),Object(U.jsx)(h.a,{error:Boolean(b.title&&n.title),fullWidth:!0,helperText:b.title&&n.title,id:"title",label:"Title",name:"title",onBlur:a,onChange:r,placeholder:"title",value:T.title}),Object(U.jsx)(h.a,{error:Boolean(b.description&&n.description),fullWidth:!0,helperText:b.description&&n.description,id:"description",label:"Description",multiline:!0,name:"description",onBlur:a,onChange:r,placeholder:"Description",value:T.description}),Object(U.jsx)(h.a,{error:Boolean(b.tokenDecimals&&n.tokenDecimals),fullWidth:!0,helperText:b.tokenDecimals&&n.tokenDecimals,id:"tokenDecimals",label:"Sale Token Decimals",name:"tokenDecimals",onBlur:a,onChange:r,placeholder:"0",type:"number",value:T.tokenDecimals}),Object(U.jsx)(h.a,{error:Boolean(b.tokenSymbol&&n.tokenSymbol),fullWidth:!0,helperText:b.tokenSymbol&&n.tokenSymbol,id:"tokenSymbol",label:"Sale Token Symbol",name:"tokenSymbol",onBlur:a,onChange:r,placeholder:"tokenSymbol",value:T.tokenSymbol}),Object(U.jsx)(h.a,{error:Boolean(b.saleTarget&&n.saleTarget),fullWidth:!0,helperText:b.saleTarget&&n.saleTarget,id:"saleTarget",label:"Sale Token Amount",name:"saleTarget",onBlur:a,onChange:r,placeholder:"0",type:"number",value:T.saleTarget}),Object(U.jsx)(h.a,{error:Boolean(b.fundToken&&n.fundToken),fullWidth:!0,helperText:b.fundToken&&n.fundToken,id:"fundToken",label:"Fund Token",name:"fundToken",onBlur:a,onChange:r,select:!0,value:T.fundToken,children:Object.values(m.h).map((function(e){var n=Object(m.c)(e,c);return Object(U.jsx)(f.a,{value:n.address,children:Object(U.jsxs)("div",{className:t.row,children:[Object(U.jsx)(g.a,{src:n.image}),Object(U.jsxs)(s.a,{children:[n.name," (",n.symbol.toUpperCase(),")"]})]})},e)}))}),Object(U.jsx)(h.a,{error:Boolean(b.fundTarget&&n.fundTarget),fullWidth:!0,helperText:b.fundTarget&&n.fundTarget,id:"fundTarget",label:"Fund Token Amount",name:"fundTarget",onBlur:a,onChange:r,placeholder:"0",type:"number",value:T.fundTarget}),Object(U.jsx)(h.a,{error:Boolean(b.minFundAmount&&n.minFundAmount),fullWidth:!0,helperText:b.minFundAmount&&n.minFundAmount,id:"minFundAmount",label:"Min Fund Amount",name:"minFundAmount",onBlur:a,onChange:r,placeholder:"0",type:"number",value:T.minFundAmount}),Object(U.jsx)(h.a,{className:t.date,error:Boolean(b.startTime&&1e3*S()(T.startTime).unix()<Date.now()),fullWidth:!0,helperText:b.startTime&&1e3*S()(T.startTime).unix()<Date.now()?"You can't set Past Time":"".concat(S()(T.startTime).utc().format("YYYY-MM-DD HH:mm")," UTC (").concat(S()(T.startTime).unix(),")"),label:"Start Time",id:"startTime",name:"startTime",type:"datetime-local",value:T.startTime,InputLabelProps:{shrink:!0},onBlur:a,onChange:r}),Object(U.jsx)(h.a,{className:t.date,error:Boolean(b.endTime&&1e3*S()(T.endTime).unix()<Date.now()),fullWidth:!0,helperText:b.endTime&&1e3*S()(T.endTime).unix()<Date.now()?"You can't set Past Time":"".concat(S()(T.endTime).utc().format("YYYY-MM-DD HH:mm")," UTC (").concat(S()(T.endTime).unix(),")"),label:"End Time",id:"endTime",name:"endTime",type:"datetime-local",value:T.endTime,InputLabelProps:{shrink:!0},onBlur:a,onChange:r}),Object(U.jsx)(h.a,{className:t.date,error:Boolean(b.claimTime&&1e3*S()(T.claimTime).unix()<Date.now()),fullWidth:!0,helperText:b.claimTime&&1e3*S()(T.claimTime).unix()<Date.now()?"You can't set Past Time":"".concat(S()(T.claimTime).utc().format("YYYY-MM-DD HH:mm")," UTC (").concat(S()(T.claimTime).unix(),")"),label:"Claim Time",id:"claimTime",name:"claimTime",type:"datetime-local",value:T.claimTime,InputLabelProps:{shrink:!0},onBlur:a,onChange:r}),Object(U.jsx)(h.a,{error:Boolean(b.baseAmount&&n.baseAmount),fullWidth:!0,helperText:b.baseAmount&&n.baseAmount||"Max Fund Amount = BaseAmount * user' tier",id:"baseAmount",label:"Base Fund Token Amount",name:"baseAmount",onBlur:a,onChange:r,placeholder:"0",type:"number",value:T.baseAmount}),Object(U.jsxs)("div",{children:[Object(U.jsx)(s.a,{className:t.label,children:"Images"}),Object(U.jsxs)("div",{className:t.imagesRow,children:[T.imageObjectUrls.map((function(e,n){return Object(U.jsxs)("div",{className:t.imageItem,children:[Object(U.jsx)("img",{src:e,alt:"img"}),Object(U.jsx)(j.a,{onClick:function(){var e=T.imageObjectUrls[n],t=Object(y.a)(T.imageFiles),a=Object(y.a)(T.imageObjectUrls);a.splice(n,1),t.splice(n,1),p("imageFiles",t),p("imageObjectUrls",a),URL.revokeObjectURL(e)},children:Object(U.jsx)(v.a,{})})]},e)})),Object(U.jsx)(u.b,{id:"image-uploader",onChange:function(e){null!==e&&(p("imageFiles",[].concat(Object(y.a)(T.imageFiles),[e])),p("imageObjectUrls",[].concat(Object(y.a)(T.imageObjectUrls),[URL.createObjectURL(e)])))},placeholder:"Please upload image (10*6 ratio)",size:{width:100,height:100},value:{file:null,fileUrl:""}})]})]}),Object(U.jsx)(O.a,{className:t.button,color:"primary",disabled:!d||o||!l,fullWidth:!0,type:"submit",variant:"contained",children:"Submit"})]})}})})},Y=Object(l.a)((function(e){return{root:{},title:{color:e.colors.white,fontSize:24,fontWeight:600,margin:"16px 0"}}}));t.default=function(){var e=Y(),t=Object(d.b)(),n=t.account,a=t.library,l=t.networkId,y=t.setTxModalInfo,h=Object(p.b)().enqueueSnackbar,f=Object(b.useState)(!0),g=Object(o.a)(f,2),j=g[0],O=g[1],x=function(){var e=Object(i.a)(r.a.mark((function e(t){var i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&a&&l){e.next=2;break}return e.abrupt("return");case 2:return y(!0,"Creating IDO..."),e.prev=3,i=Object(m.a)("idoController",l),o=new T.a(a,n,i),e.next=8,o.createIDO(t);case 8:return s=e.sent,y(!0,"Creating IDO...","Please wait...",s),e.next=12,a.waitForTransaction(s);case 12:y(!1),O((function(){return!1})),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(3),console.error(e.t0),y(!1),h(e.t0.message||"Something went wrong",{variant:"error"});case 21:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}(),v=l||c.a;return Object(b.useEffect)((function(){O(!1)}),[v]),Object(b.useEffect)((function(){j||O(!0)}),[j]),Object(U.jsxs)(u.d,{children:[Object(U.jsx)(s.a,{className:e.title,children:"New IDO"}),j&&Object(U.jsx)(I,{onSubmit:x})]})}},440:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(4),r=n.n(a),i=n(90),o=n(509),l=n.n(o),s=n(24),u=function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.upload({apiKey:s.b,apiSecret:s.c,key:"".concat(Date.now()),data:t});case 2:return n=e.sent,e.abrupt("return",n.publicUrl);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=Object(i.a)(r.a.mark((function e(){var i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.result,e.prev=1,e.next=4,l.a.upload({apiKey:s.b,apiSecret:s.c,key:"".concat(Date.now()),data:i});case 4:o=e.sent,t(o.publicUrl),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),a.onerror=function(){n(a.error)},a.readAsDataURL(e)}))}},443:function(e,t){},499:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),r=n.n(a),i=n(90),o=n(6),l=n(8),s=n(112),u=n(500),c=function(){function e(t,n,a){if(Object(o.a)(this,e),this.provider=void 0,this.contract=void 0,this.provider=t,n){var r=t.getSigner();this.contract=new s.a.Contract(a,u,t).connect(r)}else this.contract=new s.a.Contract(a,u,t)}return Object(l.a)(e,[{key:"address",get:function(){return this.contract.address}},{key:"createIDO",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.createIDO(t.saleTarget,t.fundToken,t.fundTarget,t.startTime,t.endTime,t.claimTime,t.minFundAmount,t.baseAmount,t.meta);case 2:return n=e.sent,console.log("createIDO transaction hash: ".concat(n.hash)),e.abrupt("return",n.hash);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},500:function(e){e.exports=JSON.parse('[{"inputs":[{"internalType":"contract IIDOTier","name":"_tier","type":"address"},{"internalType":"address","name":"_feeReceipient","type":"address"},{"internalType":"uint256","name":"_feePercent","type":"uint256"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"pool","type":"address"},{"indexed":false,"internalType":"address","name":"creator","type":"address"}],"name":"NewIDOCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"IDOs","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"saleTarget","type":"uint256"},{"internalType":"address","name":"fundToken","type":"address"},{"internalType":"uint256","name":"fundTarget","type":"uint256"},{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"uint256","name":"endTime","type":"uint256"},{"internalType":"uint256","name":"claimTime","type":"uint256"},{"internalType":"uint256","name":"minFundAmount","type":"uint256"},{"internalType":"uint256","name":"baseAmount","type":"uint256"},{"internalType":"string","name":"meta","type":"string"}],"name":"createIDO","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"feePercent","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"feeReceipient","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getFeeInfo","outputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getIDOsCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"baseAmount","type":"uint256"}],"name":"getMaxAllocationAmount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"isIDO","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"isOperator","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_feeReceipient","type":"address"},{"internalType":"uint256","name":"_feePercent","type":"uint256"}],"name":"setFeeInfo","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"bool","name":"bSet","type":"bool"}],"name":"setOperator","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"contract IIDOTier","name":"_tier","type":"address"}],"name":"setTier","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"tier","outputs":[{"internalType":"contract IIDOTier","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"}]')}}]);
//# sourceMappingURL=7.99183a5f.chunk.js.map